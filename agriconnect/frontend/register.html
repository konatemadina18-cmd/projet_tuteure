<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Inscription - AgriConnect BouakÃ©</title>
    <link rel="stylesheet" href="styles/main.css">
    <link rel="stylesheet" href="styles/auth.css">
</head>
<body class="auth-page">
    
    <!-- Fond dÃ©coratif -->
    <div class="auth-background">
        <div class="auth-blob blob-1"></div>
        <div class="auth-blob blob-2"></div>
        <div class="auth-blob blob-3"></div>
    </div>

    <!-- Carte d'inscription centrÃ©e -->
    <div class="auth-wrapper">
        <div class="auth-container register-container">
            
            <!-- Logo et titre -->
            <div class="auth-logo">
                <a href="index.html" style="text-decoration: none; color: inherit; display: flex; flex-direction: column; align-items: center;">
                    <div class="logo-circle">
                        <img src="assets/images/logo.png.png" 
                             alt="AgriConnect BouakÃ©" 
                             class="logo-image"
                             onerror="this.src='https://via.placeholder.com/80x80/2d5016/ffffff?text=ğŸŒ¿'">
                    </div>
                    <h1 class="auth-title">Rejoignez AgriConnect ğŸŒ¿</h1>
                </a>
                <p class="auth-subtitle">âœ¨ CrÃ©ez votre compte en 2 minutes et commencez votre aventure agricole !</p>
            </div>

            <!-- Formulaire d'inscription -->
            <form id="registerForm" class="auth-form">
                
                <!-- Ligne Nom/PrÃ©nom -->
                <div class="form-row">
                    <div class="input-group">
                        <div class="input-icon">ğŸ‘¤</div>
                        <input type="text" id="prenom" name="prenom" 
                               class="auth-input" 
                               placeholder="PrÃ©nom" required>
                    </div>
                    <div class="input-group">
                        <input type="text" id="nom" name="nom" 
                               class="auth-input" 
                               placeholder="Nom" required>
                    </div>
                </div>

                <!-- Email et TÃ©lÃ©phone -->
                <div class="input-group">
                    <div class="input-icon">ğŸ“§</div>
                    <input type="email" id="email" name="email" 
                           class="auth-input" 
                           placeholder="Adresse email" required>
                </div>

                <!-- TÃ©lÃ©phone (CÃ´te d'Ivoire uniquement) -->
                <div class="input-group">
                    <div class="input-icon">ğŸ“±</div>
                    <input type="tel" id="telephone" name="telephone" 
                           class="auth-input" 
                           placeholder="NumÃ©ro de tÃ©lÃ©phone (Ex: 0712345678)" required>
                    <small style="color: #7f8c8d; font-size: 0.75rem; margin-top: 3px; display: block;">
                        ğŸ“ CÃ´te d'Ivoire uniquement (+225)
                    </small>
                </div>

                <!-- RÃ´le et Commune -->
                <div class="form-row">
                    <div class="input-group">
                        <div class="input-icon">ğŸ¯</div>
                        <select id="role" name="role" class="auth-input" required onchange="toggleAdminCode()">
                            <option value="">Je suis...</option>
                            <option value="ACHETEUR">ğŸ›’ Acheteur</option>
                            <option value="PRODUCTEUR">ğŸ‘¨â€ğŸŒ¾ Producteur</option>
                            <option value="LIVREUR">ğŸšš Livreur</option>
                            <option value="ADMIN">âš™ï¸ Administrateur</option>
                        </select>
                    </div>
                    <div class="input-group">
                        <div class="input-icon">ğŸ“</div>
                        <select id="commune" name="commune" class="auth-input" required>
                            <option value="">Ma commune</option>
                            <option value="BouakÃ©-Ville">BouakÃ©-Ville</option>
                            <option value="Bounda">Bounda</option>
                            <option value="Brobo">Brobo</option>
                            <option value="DjÃ©bonoua">DjÃ©bonoua</option>
                            <option value="Sakassou">Sakassou</option>
                            <option value="BÃ©oumi">BÃ©oumi</option>
                            <option value="Botro">Botro</option>
                        </select>
                    </div>
                </div>

                <!-- Code Admin (affichÃ© uniquement si ADMIN est sÃ©lectionnÃ©) -->
                <div class="input-group" id="adminCodeGroup" style="display: none;">
                    <div class="input-icon">ğŸ”</div>
                    <input type="password" id="admin_code" name="admin_code" 
                           class="auth-input" 
                           placeholder="Code secret administrateur (requis)">
                    <small style="color: #7f8c8d; font-size: 0.85rem; margin-top: 5px; display: block;">
                        âš ï¸ Un code secret est requis pour crÃ©er un compte administrateur
                    </small>
                </div>

                <!-- Mot de passe -->
                <div class="form-row">
                    <div class="input-group">
                        <div class="input-icon">ğŸ”’</div>
                        <input type="password" id="mot_de_passe" name="mot_de_passe" 
                               class="auth-input" 
                               placeholder="Mot de passe" required minlength="6">
                    </div>
                    <div class="input-group">
                        <div class="input-icon">âœ…</div>
                        <input type="password" id="confirmation_mdp" name="confirmation_mdp" 
                               class="auth-input" 
                               placeholder="Confirmer le mot de passe" required>
                    </div>
                </div>

                <!-- Conditions -->
                <div class="checkbox-container">
                    <label class="checkbox-label">
                        <input type="checkbox" id="acceptTerms" required>
                        <span class="checkmark"></span>
                        J'accepte les <a href="#" class="text-link">conditions d'utilisation</a>
                    </label>
                </div>

                <!-- Bouton d'inscription -->
                <button type="submit" class="auth-button register-button">
                    <span class="button-text">CrÃ©er mon compte</span>
                    <span class="button-icon">ğŸ‰</span>
                </button>
            </form>

            <!-- Lien vers connexion -->
            <div class="auth-switch">
                <p>DÃ©jÃ  un compte ?</p>
                <a href="login.html" class="switch-link" style="display: inline-block; margin-top: 8px;">
                    Se connecter
                </a>
            </div>

        </div>
    </div>

    <script src="scripts/api.js"></script>
    <script src="scripts/auth.js"></script>
    <script src="scripts/auth-guard.js"></script>
    <script>
        // Fonction pour afficher/masquer le champ code admin
        function toggleAdminCode() {
            const roleSelect = document.getElementById('role');
            const adminCodeGroup = document.getElementById('adminCodeGroup');
            const adminCodeInput = document.getElementById('admin_code');
            
            if (roleSelect.value === 'ADMIN') {
                adminCodeGroup.style.display = 'block';
                adminCodeInput.required = true;
            } else {
                adminCodeGroup.style.display = 'none';
                adminCodeInput.required = false;
                adminCodeInput.value = '';
            }
        }
        
        // VÃ©rifier si l'utilisateur est dÃ©jÃ  connectÃ© et rediriger
        document.addEventListener('DOMContentLoaded', function() {
            requireGuest();
        });
    </script>
</body>
</html>